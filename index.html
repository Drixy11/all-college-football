<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>College Football – Full Week</title>
<style>
    body {
        background: #003300;
        color: #ffcc00;
        font-family: Arial, sans-serif;
        margin: 0;
        text-align: center;
    }
    h1 {
        margin-top: 20px;
        font-size: 36px;
        font-weight: bold;
    }
    table {
        width: 100%;
        margin-top: 20px;
        border-collapse: collapse;
        color: white;
    }
    th, td {
        padding: 12px;
        border-bottom: 1px solid #225522;
        font-size: 18px;
    }
    th {
        background: #004400;
        font-weight: bold;
    }
    tr:nth-child(even) {
        background: #002800;
    }
    .btn {
        background: #ffcc00;
        color: #003300;
        padding: 10px 20px;
        border-radius: 8px;
        margin: 10px;
        cursor: pointer;
        border: none;
        font-weight: bold;
    }
</style>
</head>
<body>

<h1>College Football – Full Week</h1>

<button class="btn" onclick="changeWeek(-1)">← Previous Week</button>
<button class="btn" onclick="changeWeek(1)">Next Week →</button>

<h3 id="weekTitle">Loading...</h3>

<table>
    <thead>
        <tr>
            <th>Time</th>
            <th>Div</th>
            <th>Matchup</th>
            <th>TV / Result</th>
        </tr>
    </thead>
    <tbody id="games"></tbody>
</table>

<script>
let currentWeek = 12;
let currentYear = 2025;

function parseTime(str) {
    if (!str || str === "TBA" || str === "Final") return 999999;
    let d = new Date("1/1/2000 " + str);
    return d.getTime();
}

function changeWeek(dir) {
    currentWeek += dir;
    loadGames();
}

function loadGames() {
    document.getElementById("games").innerHTML = "";
    document.getElementById("weekTitle").innerText = "Loading...";

    let url = `/api/schedule?year=${currentYear}&week=${currentWeek}`;

    fetch(url)
        .then(res => res.json())
        .then(data => {
            let allGames = [];

            Object.keys(data.divisions).forEach(div => {
                data.divisions[div].forEach(g => {
                    allGames.push({
                        time: g.time || "TBA",
                        div,
                        matchup: g.matchup || "",
                        tv: g.tv || g.result || ""
                    });
                });
            });

            allGames.sort((a,b) => parseTime(a.time) - parseTime(b.time));

            document.getElementById("weekTitle").innerText =
                `Loaded ${allGames.length} games for Week ${currentWeek}`;

            let tbody = document.getElementById("games");
            tbody.innerHTML = "";

            allGames.forEach(g => {
                tbody.innerHTML += `
                    <tr>
                        <td>${g.time}</td>
                        <td>${g.div}</td>
                        <td>${g.matchup}</td>
                        <td>${g.tv}</td>
                    </tr>
                `;
            });
        });
}

loadGames();
</script>

</body>
</html>
